
# A/B Testing Landing Pages with Firebase & Next.js: Playbook

This playbook guides you through setting up and running A/B tests for your SecureTomorrow landing page using Firebase Remote Config and Next.js, with the help of an in-app A/B Test Configurator tool.

## 1. Introduction to A/B Testing

A/B testing (or split testing) is a method of comparing two or more versions of a webpage or app feature to determine which one performs better. In our case, we'll use it to test different variations of the landing page content (e.g., headlines, CTAs) to optimize for conversions.

**Firebase Tools Used:**
- **Firebase Remote Config:** Allows you to change the behavior and appearance of your app without publishing an app update. We'll use it to control which landing page variation a user sees.
- **Firebase Hosting:** (Implicitly used) To host your Next.js application.
- **Firebase A/B Testing:** A Firebase feature that helps you run, analyze, and scale product and marketing experiments.

## 2. Prerequisites

### 2.1. Firebase Project Setup
- Ensure you have a Firebase project created. If not, create one at [https://console.firebase.google.com/](https://console.firebase.google.com/).
- Your project should have Billing enabled if you plan to use Firebase A/B Testing features extensively, though Remote Config itself has a generous free tier.

### 2.2. Add Firebase to Your Next.js App
- The project is already configured with the Firebase SDK. The initialization logic is in `src/lib/firebase.ts`.
- **Crucially, you must create a `.env.local` file** in the root of your project. Copy the contents of `.env.example` (if it exists, otherwise create it from scratch) into `.env.local` and replace the placeholder values with your actual Firebase project's configuration credentials. You can find these in your Firebase project settings (Project Overview > Project settings > General > Your apps > SDK setup and configuration).
  Example `.env.local` content:
  ```env
  NEXT_PUBLIC_FIREBASE_API_KEY=AIzaSy...
  NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project-id.firebaseapp.com
  NEXT_PUBLIC_FIREBASE_PROJECT_ID=your-project-id
  NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your-project-id.appspot.com
  NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=1234567890
  NEXT_PUBLIC_FIREBASE_APP_ID=1:1234567890:web:abcdef123456
  NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=G-ABCDEFGHIJ
  ```
- **Important:** After creating or modifying `.env.local`, you **MUST restart your Next.js development server** (`npm run dev` or `yarn dev`) for the changes to take effect.

## 3. Setting up Landing Page Variations in Code

The application is set up to allow variations in the Hero Section of the landing page. The main page of the application (`/`) is now an A/B Test Configurator tool. A side-by-side A/B test preview page is available at `/landing-preview`.

### 3.1. How it Works
- **`src/lib/firebase.ts`**: Initializes the Firebase app and Remote Config. It sets default values for a `heroConfig` Remote Config parameter.
- **`src/hooks/useRemoteConfigValue.ts`**: This custom React hook fetches a specified parameter's value from Firebase Remote Config. It handles loading states and uses default values if the fetch fails or if the app is running server-side. (Note: This hook is used if you implement a live landing page driven by a single Remote Config parameter. The preview page now uses query params).
- **`/` (root) page (formerly `src/app/admin/ab-test-configurator/page.tsx`)**: This is the **A/B Test Configurator Tool**. It allows you to define two versions (A and B) of hero section content, generate/download their JSON, and preview them.
- **`/landing-preview` page (formerly `src/app/page.tsx`)**: This page now shows a side-by-side preview of two HeroSection configurations, which can be dynamically passed from the A/B Test Configurator tool via URL parameters.
- **`src/components/landing/HeroSection.tsx`**: This component accepts props (`headline`, `subHeadline`, `ctaText`) that can be dynamically set based on the `heroConfig` (for live A/B tests fetched from Remote Config) or from configurations passed to the preview page.

### 3.2. Configurable Elements
The `heroConfig` parameter in Remote Config (or the JSON generated by the tool) should be a JSON string with the following structure:
```json
{
  "headline": "Your Catchy Headline Here",
  "subHeadline": "(Your compelling sub-headline)",
  "ctaText": "Your Call to Action Text"
}
```

### 3.3. Preparing New Variations (Using the A/B Test Configurator Tool)
To test different Hero Section content:
1.  Navigate to the root of your application (e.g., `http://localhost:9002/`). This is the **A/B Test Configurator Tool**.
2.  Use the "Version A" and "Version B" forms to input the headline, sub-headline, and CTA text for each variation you want to compare.
3.  The tool will automatically display the generated JSON string for each version.
4.  You can **Copy** or **Download** the JSON for each version. This JSON will be used in Firebase Remote Config.
5.  Click the **"Render Pages for Preview"** button. This will open the `/landing-preview` page with both Version A and Version B displayed side-by-side, using the content you just configured. This allows for visual review.
6.  If you need to make structural changes to the `HeroSection` component itself, you would:
    *   Modify `HeroSection.tsx` or create new components.
    *   Adjust how the configurations are used if the structure of the JSON needs to change (though it's recommended to keep the `headline`, `subHeadline`, `ctaText` structure for simplicity with the tool).

## 4. Configuring Firebase Remote Config

### 4.1. Access Remote Config
- Go to your Firebase project in the Firebase Console.
- In the left-hand navigation pane, under the "Engage" section (or "Build" in newer UIs), click on **Remote Config**.

### 4.2. Define the `heroConfig` Parameter
1.  Click **"Add parameter"** or **"Create configuration"**.
2.  **Parameter key:** Enter `heroConfig`. (If you plan to run multiple variants simultaneously beyond a simple A/B, you might consider different parameter keys like `heroConfigVariantA`, `heroConfigVariantB`, or manage variants within a single JSON if your logic supports it. For a standard A/B test, one `heroConfig` parameter is typical, and the A/B testing tool will assign different values to it for different user groups).
3.  **Data type:** Select **String**. (Remote Config will store our JSON configuration as a string).
4.  **Default value (server-side):** This is the value used if the app can't fetch a value for a user. This will be your **control/baseline** version.
    - Use the **A/B Test Configurator Tool** (root `/` path) to generate the JSON for your baseline/control version (e.g., by filling out "Version A" with your baseline content).
    - Copy the generated JSON and paste it here. For example:
      ```json
      {"headline":"Ensure Your Family's Financial Security","subHeadline":"(even when you can't be there for them)","ctaText":"Secure My Family's Future Now"}
      ```
5.  Click **"Save"**.

### 4.3. Adding Variations for an A/B Test in Firebase
You will define your variations when creating an A/B test (see Section 6). The A/B Testing tool will override the default `heroConfig` value for users in specific experiment variants. You will use the JSON generated by the **A/B Test Configurator Tool** for each variant.

### 4.4. Publish Changes
- After defining your parameter and its default value in the Firebase Console, click **"Publish changes"** in the Remote Config dashboard. Changes might take a few minutes to propagate.

## 5. Deploying Your App
- Ensure your Next.js application (with the Firebase SDK and updated pages) is deployed to Firebase Hosting or your preferred hosting platform.
  ```bash
  # If using Firebase CLI for hosting
  firebase deploy --only hosting
  ```
  (This step is more relevant when you are ready to serve a live landing page that actually fetches from Remote Config, not just for using the local configurator and previewer).

## 6. Creating an A/B Test in Firebase Console

This is where you define your experiment to test different `heroConfig` values against each other for your actual users.

### 6.1. Navigate to A/B Testing
- In the Firebase Console, under the "Engage" section, click on **A/B Testing**.

### 6.2. Set Up a New Experiment
1.  Click **"Create experiment"**.
2.  Choose **Remote Config**.
3.  **Basics:**
    *   **Name:** Give your experiment a descriptive name (e.g., "Hero Headline Test - Q3").
    *   **Description:** (Optional) Add more details.
4.  **Targeting:**
    *   **Target users:** Typically, you'll target "All users" or a percentage of your users.
    *   **Activation event:** `first_open` is common for app-wide configs. For web, this often means on page load for pages that utilize this config.
5.  **Goals:**
    *   **Primary metric:** Select what you want to optimize for (e.g., a custom conversion event like `form_submission_successful`).
6.  **Variants:**
    *   **Baseline:** This is your control group.
        *   Parameter: Select `heroConfig`.
        *   Value: It should typically use the "parameter's default value" (which you set in step 4.2 using the JSON from "Version A" or your designated control from the configurator tool).
    *   **Variant A (or your experimental variant):**
        *   Click **"Add variant"**.
        *   Name your variant (e.g., "New Headline CTA").
        *   Parameter: `heroConfig`.
        *   Value: Use the **A/B Test Configurator Tool** (root `/` path) to generate the JSON string for this experimental variation (e.g., by filling out "Version B" in the tool). Copy the JSON and paste it here. For example:
          ```json
          {"headline":"Unlock Financial Peace of Mind","subHeadline":"(protecting your loved ones, always)","ctaText":"Get Protected Today"}
          ```
    *   **Distribution:** Adjust the percentage of users who will see each variant.
7.  Click **"Review"** and then **"Start experiment"**.

### 6.3. Monitor and Analyze
- Monitor progress in the A/B Testing dashboard. Firebase will help determine a statistically significant winner.

## 7. Iterating and Adding New Variations

1.  **Hypothesize:** What do you want to improve?
2.  **Generate JSONs:** Use the A/B Test Configurator Tool (root `/` path) to create content for "Version A" and "Version B". Click "Render Pages for Preview" to compare them visually on the `/landing-preview` page.
3.  **Download/Copy JSON:** For the version you want to use as your new experimental variant in Firebase, copy or download its JSON.
4.  **A/B Test Setup:** In Firebase A/B Testing, create a new experiment or edit an existing one, pasting the new JSON for the relevant variant.
5.  **Deploy (if code changes were made):** If your new variation required structural changes beyond text (not handled by the current tool), deploy your app code.

## 8. Best Practices

- **Clear Hypothesis.**
- **One Major Change at a Time** (if not using a multivariate testing tool).
- **Sufficient Sample Size & Duration.**
- **Meaningful Metrics.**
- **Test in Development:** Use the A/B Test Configurator and the `/landing-preview` page to thoroughly review your variations before setting up a live experiment in Firebase.

## 9. Troubleshooting

- **Error: `FirebaseError: Installations: Missing App configuration value: "projectId"` (or similar missing config values)**
    *   **Cause:** Firebase SDK not getting necessary configuration.
    *   **Solution:**
        1.  Ensure `.env.local` exists in the project root.
        2.  Ensure correct Firebase credentials (prefixed with `NEXT_PUBLIC_`) are in `.env.local`.
        3.  **Restart your Next.js development server** after changes to `.env.local`.
    *   `src/lib/firebase.ts` provides console warnings for missing config.

- **Remote Config Values Not Updating (for a live page using `useRemoteConfigValue`):**
    *   Ensure "Publish changes" in Firebase Remote Config console.
    *   Note fetch intervals (dev vs. prod). Forcing app restart or clearing cache might help during testing.

- **A/B Test Not Starting/No Data:**
    *   Ensure your app correctly fetches and applies Remote Config values (if a live page is consuming it).
    *   Check activation event for your A/B test.
    *   Verify Firebase Analytics integration.

- **Preview Page (`/landing-preview`) Not Showing Correct Content:**
    *   Ensure you clicked "Render Pages for Preview" from the main configurator tool (`/`).
    *   Check the URL of the preview page for `configA` and `configB` query parameters.
    *   Check the browser console on the preview page for any JSON parsing errors.
    *   Ensure the JSON generated by the configurator is valid.

This playbook should provide a solid foundation for conducting A/B tests on your SecureTomorrow landing page. Good luck!

    